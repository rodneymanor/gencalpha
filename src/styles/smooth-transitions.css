/* Smooth UI Transitions - Claude-style Implementation */

/* Core Transition Variables */
:root {
  /* Claude-style Easing Curves */
  --ease-out-expo: cubic-bezier(0.19, 1, 0.22, 1);
  --ease-in-out-soft: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
  --ease-claude: cubic-bezier(0.32, 0.72, 0, 1);
  
  /* Timing Constants */
  --hero-expand-duration: 400ms;
  --message-appear-duration: 300ms;
  --slideout-duration: 400ms;
  --slideout-close-duration: 250ms;
  --scroll-duration: 250ms;
}

/* ========================================
   SLIDEOUT PANEL TRANSITIONS - Claude Style
   ======================================== */

.slideout-claude-transition {
  transition-property: transform;
  transition-timing-function: var(--ease-claude);
}

.slideout-claude-transition.opening {
  transition-duration: var(--slideout-duration);
}

.slideout-claude-transition.closing {
  transition-duration: var(--slideout-close-duration);
}

/* ========================================
   HERO TO CHAT EXPANSION - Claude Style
   ======================================== */

.claude-chat-container {
  position: relative;
  width: 100%;
  min-height: 100vh;
  max-height: 100vh;
  display: flex;
  flex-direction: column;
  will-change: transform;
  transition: transform var(--hero-expand-duration) var(--ease-claude);
  overflow: hidden;
}

/* Hero state: show full content normally positioned */
.claude-chat-container.hero-state {
  transform: translateY(0);
}

/* Hero state: hide messages area */
.claude-chat-container.hero-state .chat-messages-area {
  opacity: 0 !important;
  pointer-events: none;
}

/* Expanded state: slide up to reveal full chat */
.claude-chat-container.expanded {
  transform: translateY(0);
}

.claude-chat-container.transitioning {
  /* Performance optimization during transition */
  will-change: transform, height;
}

/* Hero content positioning */
.hero-content {
  opacity: 1;
  transition: opacity var(--hero-expand-duration) var(--ease-claude);
}

.hero-content.hero-hidden {
  opacity: 0;
  pointer-events: none;
  /* Remove hero from layout when chat expands so messages can occupy space */
  position: absolute;
  inset: 0;
}

/* Chat messages area */
.chat-messages-area {
  flex: 1;
  overflow-y: auto;
  opacity: 0;
  transition: opacity 0.3s ease-in-out 0.2s; /* Delayed reveal */
}

.claude-chat-container.expanded .chat-messages-area {
  opacity: 1 !important;
  pointer-events: auto;
}

/* Hero Input Animation */
.hero-input-area {
  transition: all var(--hero-expand-duration) var(--ease-claude);
  opacity: 1;
  transform: translateY(0);
}

.claude-chat-container.expanded .hero-input-area {
  opacity: 0;
  transform: translateY(-20px);
  pointer-events: none;
}

/* Chat Interface Reveal */
.chat-interface {
  opacity: 1;
  transform: translateY(0);
  transition: all var(--hero-expand-duration) var(--ease-claude);
}

/* The interface is always visible, but content positioning changes */
.claude-chat-container.hero-state .chat-interface {
  /* Hero state: interface is centered */
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.claude-chat-container.expanded .chat-interface {
  /* Expanded state: interface flows normally */
  display: block;
  min-height: auto;
}

/* ========================================
   CHAT MESSAGES FLOW
   ======================================== */

.messages-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  position: relative;
}

.messages-list {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  scroll-behavior: smooth;
  /* Smooth scrolling with momentum on iOS */
  -webkit-overflow-scrolling: touch;
}

/* Claude-style: Auto-scroll spacer pushes messages to bottom initially */
.messages-list::before {
  content: '';
  flex: 1;
  min-height: 0;
  transition: flex var(--scroll-duration) var(--ease-in-out-soft);
}

/* Fixed input area at bottom - Claude style */
.chat-input-fixed {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--background);
  border-top: 1px solid var(--border-subtle);
  padding: 0.75rem 1rem;
  z-index: 50;
  /* Compact height for minimal design */
}

/* Individual Message Animation */
.message {
  flex-shrink: 0;
  animation: slideUpFade var(--message-appear-duration) var(--ease-out-expo) forwards;
  opacity: 0;
  transform: translateY(20px);
}

/* Staggered message appearance */
.message:nth-last-child(1) { animation-delay: 0ms; }
.message:nth-last-child(2) { animation-delay: 50ms; }
.message:nth-last-child(3) { animation-delay: 100ms; }
.message:nth-last-child(4) { animation-delay: 150ms; }
.message:nth-last-child(5) { animation-delay: 200ms; }

@keyframes slideUpFade {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Typing Indicator Animation */
.typing-indicator {
  animation: fadeInUp var(--message-appear-duration) var(--ease-out-expo) forwards;
  opacity: 0;
  transform: translateY(10px);
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ========================================
   SLIDEOUT INTEGRATION - FLEXBOX APPROACH
   ======================================== */

/* Layout Container - Flexbox approach for true responsiveness */
.slideout-layout-container {
  display: flex;
  height: 100vh;
  overflow: hidden;
}

/* Main Content Area - Naturally flexible */
.main-content {
  flex: 1;
  min-height: 100vh;
  overflow: auto;
}

/* Slideout Panel - Width-based animation */
.slideout-panel {
  width: 0;
  overflow: hidden;
  transition: width var(--slideout-duration) var(--ease-claude);
  background: var(--background);
  /* Soft UI border - barely visible is the goal */
  border-left: 1px solid var(--border); /* 6% opacity - design system default */
  z-index: 50;
}

/* Panel open states - Mobile first */
.slideout-panel.open {
  width: 100vw; /* Mobile: Full width */
}

/* Tablet: 70% width with max 480px */
@media (min-width: 768px) {
  .slideout-panel.open {
    width: min(70vw, 480px);
  }
}

/* Desktop: Fixed widths based on size */
@media (min-width: 1024px) {
  .slideout-panel.open {
    width: 600px; /* Default lg width */
  }
  
  .slideout-panel.open[data-panel-width="sm"] {
    width: 320px;
  }
  
  .slideout-panel.open[data-panel-width="md"] {
    width: 384px;
  }
  
  .slideout-panel.open[data-panel-width="xl"] {
    width: 800px;
  }
}

/* Panel closing transition */
.slideout-panel:not(.open) {
  transition: width var(--slideout-close-duration) var(--ease-claude);
}

/* Slideout Content Animation */
.slideout-content {
  opacity: 0;
  transform: translateY(20px);
  transition: all var(--slideout-duration) var(--ease-claude);
  transition-delay: 100ms;
}

.slideout-panel.open .slideout-content {
  opacity: 1;
  transform: translateY(0);
}

/* ========================================
   RESPONSIVE BEHAVIOR - FLEXBOX APPROACH
   ======================================== */

/* Optional: Add overlay effects for mobile/tablet if desired */
.slideout-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(2px);
  opacity: 0;
  transition: opacity var(--slideout-duration) var(--ease-claude);
  z-index: 40;
  pointer-events: none;
}

.slideout-backdrop.open {
  opacity: 1;
  pointer-events: auto;
}

/* Hide backdrop on desktop since we use side-by-side layout */
@media (min-width: 1024px) {
  .slideout-backdrop {
    display: none;
  }
}

/* ========================================
   INTERACTION STATES
   ======================================== */

/* Smooth hover transitions */
.interactive-element {
  transition: all 200ms var(--ease-in-out-soft);
}

.interactive-element:hover {
  transform: translateY(-1px);
}

.interactive-element:active {
  transform: translateY(0) scale(0.98);
}

/* Focus states with soft ring */
.focus-ring {
  transition: all 200ms var(--ease-in-out-soft);
}

.focus-ring:focus-visible {
  box-shadow: 0 0 0 2px var(--ring);
  outline: none;
}

/* ========================================
   PERFORMANCE OPTIMIZATIONS
   ======================================== */

/* Contain layout changes during animations */
.animation-container {
  contain: layout style paint;
}

/* Hardware acceleration for smooth transitions */
.gpu-accelerated {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  .claude-chat-container,
  .message,
  .slideout-panel,
  .main-content,
  .interactive-element {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ========================================
   UTILITY CLASSES
   ======================================== */

.fade-in {
  animation: fadeIn 300ms var(--ease-out-expo) forwards;
}

.slide-up {
  animation: slideUp 300ms var(--ease-out-expo) forwards;
}

.bounce-in {
  animation: bounceIn 400ms var(--ease-bounce) forwards;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { 
    opacity: 0;
    transform: translateY(20px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes bounceIn {
  0% {
    opacity: 0;
    transform: scale(0.3);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}
